% RESULTS
%   - Show the unbounded Queue Graph and the mess it makes of LB and GM
%   - Show soft ECVN allows more work to be done, possibly at the cost of accumulating K.
%   - Shwo that HARD ecn allows the best operation -- work gets done and less K is accumlated.

% Show a control. 
% Normal operation. Highlight the bursty peaks from the \ac{DGI} algorithm running
% Point out the average queue size as a second line.
% State a relationship between the average queue size and the message delay.

% Introduce a sufficent amount of traffic to make the queue drain off slowly, recreating the previous figure
% State again that as the amount of other traffic increases the time to drain the queue starts to increase
% State that this does not affect normal operation because the \ac{DGI} has slack built into the schedule to ensure that a normal amount of background traffic does not cripple the \ac{DGI}.
% State that as the traffic increases further, eventually it will over flow the queue
% Show the unbounded queue growth for a drop tail queue.

% Introduce the \ac{RED} queue.
% Show that the \ac{RED} queue, without notifying the \ac{DGI} can do some management, but it isn't sufficent to keep the groups together.
% Show that based on the control, less work gets done and the groups change more frequently.

% Introduce the \ac{ECN} notification
% If the \ac{RED} queue allows \ac{DGI} traffic to pass (making the \ac{RED} queue more like a drop-tail for \ac{DGI} traffic) show that it improves on the previous scenario.
% Show that however, eventually the traffic reaches a threshold where the stratedgy is not sufficent to prevent issues.
% Introduce the \ac{DGI} reacting to the notifications.
% Show that when the \ac{DGI} goes into a maintain mode the average traffic drops.
% Show that this allows a large group to be maintained and the migrations to proceed as normal (with the time reduced schedule).

% Introduce HARD groupbreaks.
% Show that a hard group break greatly reduces traffic (even more than previously) & that this allows the \ac{DGI} to determine how to split.
% Demonstrate a worst-case scenario where the group break is not optimal.
% Show that a planned hard break allows that group to continue operating.

\section{Results}
\label{sect:results}

\begin{figure}
\centering
\begin{minipage}{0.5\textwidth}
\centering
\includegraphics[width=\textwidth]{a-qsizeot-notraffic-all.pdf}
\captionof{figure}{Plot of the queue size for a queue used to send traffic from switch A to the router. In this scenario, the only traffic is created by the \ac{DGI}. The largest peaks are created by the execution of the Group Management module. Load Balancing migrations produce each of the smaller peaks.}
\label{fig:plota}
\end{minipage}%
\begin{minipage}{0.5\textwidth}
\centering
\includegraphics[width=\textwidth]{c-migrations-no-traffic-all.pdf}
\captionof{figure}{Plot of the net generation for each process in the system. As processes migrate power, their net generation moves towards zero.}
\label{fig:plotc}
\end{minipage}
\end{figure}

Figures \ref{fig:plota}, \ref{fig:plotb} and \ref{fig:plotc} show the normal operation of the system.
In this configuration, there is no congestion on the network. 
The \ac{DGI}s start, group together and then begin migrating power between processes.
Figure \ref{fig:plota} plots the queue size over time for a queue used to send packets from a switch to the router.
Figure \ref{fig:plotb} is a detailed view of a portion of Figure \ref{fig:plota}.
Figure \ref{fig:plotb} shows the queue size during the normal operation of group management as well as the first migration of the load balancing module.
The dotted line plots the \ac{EWMA} of the size of the queue.
From this experiment we establish the $min_{th}$ value used as a \ac{RED} queue parameter.
The traffic generated by each step of the group management algorithm is very bursty.
It should be obvious that the tightness of the clock synchronization in the group affect how large this peak is.
Figure \ref{fig:plotc} plots the power level of the processes in the system.
Like \cite{HILTESTBED}, the level of the power at a process is the net sum of its power generation capability and load.
As power is shared on the network, processes with excess generation, converge toward zero net power.
Demand processes also converge toward zero net power.
The number of migrations completed is a good metric for how much work can be performed.
%Figure \ref{fig:plotc} represents NUMBER migrations between the 30 processes used in the control.

\begin{figure}
\centering
\includegraphics[width=0.5\linewidth]{b-qsizeot-notraffic-120s-130s.pdf}
\caption{Detailed view of Figure \ref{fig:plota}. The left most peak is from the maintenance of a group, and the 3 smaller peaks are from Load Balancing migrations. The average queue size is only updated with a new packet is enqueued.}
\label{fig:plotb}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.5\linewidth]{e-qsizeot-nonotifications-2mbpstraffic-120s-130s.pdf}
\caption{Detailed view of the effect on queue size as other network traffic is introduced. Compared to Figure \ref{fig:plotb}, the peaks are taller and wider. Background traffic causes the average queue size to be updated more frequently, however, the average queue size is not significantly affected by the added traffic.}
\label{fig:plote}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.5\linewidth]{f-qsizeot-nonotifications-4mbpstraffic-120s-130s.pdf}
\caption{Detailed view of the effect on queue size as other network traffic is introduced. With no \ac{ECN} notifications, the peak from Group Management is much larger. The congestion is sufficient that at this moment in the simulation, 9 processes have left the primary group, leading to the smaller load balancing peaks.}
\label{fig:plotf}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.5\linewidth]{i-qsizeot-softnotifications-4mbpstraffic-120s-130s.pdf}
\caption{Detailed view of the effect on queue size as other network traffic is introduced. In this scenario, the ECN notifications put Group Management into a maintenance mode that reduces its message complexity and switches Load Balancing to slower migration schedule. As a result, the average queue size stay closer to 200 packets, the primary group does not split, and no migrations are lost.}
\label{fig:ploti}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.5\linewidth]{k-qsizeot-softnotificationsonly-64mbpstraffic-120s-130s.pdf}
\caption{Detailed view of the effect on queue size as a large amount network traffic is introduced. Groups are unstable and processes occasionally leave the main group. The group management peak is small because of the soft notification and load balancing peaks are large because the main group is still most of the processes (28 of 30 at the plotted interval). Several migrations are lost due to delays.}
\label{fig:plotk}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.5\linewidth]{l-qsizeot-allnotifications-64mbpstraffic-120s-130s.pdf}
\caption{Detailed view of the effect on queue size as a large amount of network traffic is introduced. In this scenario, hard notifications cause the groups to divide. As a result of the smaller groups, the group management and load balancing peaks are smaller than those in \ref{fig:plotk}. No migrations are lost during execution.}
\label{fig:plotl}
\end{figure}


Figure \ref{fig:plote} shows the queue size as the network traffic begins to increase.
The \ac{DGI}s in these experiments use a schedule that allows for some congestion to occur before processes are disrupted.
This slack gives the network devices the opportunity to identify when the network congestion will go beyond the acceptable threshold.

\begin{figure}
\centering
\includegraphics[width=0.5\linewidth]{g-lostm-nonotifications-4mbpstraffic-all.pdf}
\caption{Count of lost migrations from all processes over time. As migrations proceed, some migrations are counted as lost until the second process confirms it has been completed. In this scenario without congestion management, a large number of migrations are lost as a result of message delay.}
\label{fig:plotg}
\end{figure}

Figure \ref{fig:plotf} shows an example of congestion affecting the physical network without \ac{ECN}.
As a result of the congestion in Figure \ref{fig:plotf}, processes leave the main group.
Additionally power migrations are affected: migrations are lost, or the supply process is left uncertain of migrations completions.
Figure \ref{fig:plotg} plots the count of failed migrations over time.
%In this scenario, only XXX migrations are completed compared to the control.

Figure \ref{fig:ploti} shows an example of the \ac{ECN} algorithm notifying processes of the congestion.
Compared to the scenario in Figure \ref{fig:plotf}, the \ac{ECN} algorithm successfully prevents the group from dividing, and increases the number of migrations by reducing the number of attempted migrations each round.

Figures \ref{fig:plotl} and \ref{fig:plotk} show an example of a more extreme congestion scenario.
In Figure \ref{fig:plotl}, the \ac{RED} algorithm shares a Hard \ac{ECN} notification.
This notification causes the \ac{DGI} to switch to a smaller fallback configuration.
This fallback configuration decreases the queue usage from Figure \ref{fig:plotk} to Figure \ref{fig:plotl}.
Without this fallback configuration behavior, the system is greatly affected by the traffic.

%Table X summarizes the number of migrations and number of failed migrations for each of the presented scenarios.
